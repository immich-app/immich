-- NOTE: This file is auto generated by ./sql-generator

-- EventEntityRepository.getById
select
  "event".*,
  (
    select
      to_json(obj)
    from
      (
        select
          "id",
          "name",
          "email",
          "avatarColor",
          "profileImagePath",
          "profileChangedAt"
        from
          "user"
        where
          "user"."id" = "event"."ownerId"
      ) as obj
  ) as "owner",
  (
    select
      count("album"."id") as "albumCount"
    from
      "album"
    where
      "album"."eventId" = "event"."id"
      and "album"."deletedAt" is null
  ) as "albumCount"
from
  "event"
where
  "event"."id" = $1
  and "event"."deletedAt" is null

-- EventEntityRepository.getByIds
select
  "event".*,
  (
    select
      to_json(obj)
    from
      (
        select
          "id",
          "name",
          "email",
          "avatarColor",
          "profileImagePath",
          "profileChangedAt"
        from
          "user"
        where
          "user"."id" = "event"."ownerId"
      ) as obj
  ) as "owner",
  (
    select
      count("album"."id") as "albumCount"
    from
      "album"
    where
      "album"."eventId" = "event"."id"
      and "album"."deletedAt" is null
  ) as "albumCount"
from
  "event"
where
  "event"."id" in $1
  and "event"."deletedAt" is null

-- EventEntityRepository.getOwned
select
  "event".*,
  (
    select
      to_json(obj)
    from
      (
        select
          "id",
          "name",
          "email",
          "avatarColor",
          "profileImagePath",
          "profileChangedAt"
        from
          "user"
        where
          "user"."id" = "event"."ownerId"
      ) as obj
  ) as "owner",
  (
    select
      count("album"."id") as "albumCount"
    from
      "album"
    where
      "album"."eventId" = "event"."id"
      and "album"."deletedAt" is null
  ) as "albumCount"
from
  "event"
where
  "event"."ownerId" = $1
  and "event"."deletedAt" is null
order by
  "event"."createdAt" desc

-- EventEntityRepository.create
insert into
  "event" ("eventName", "ownerId", "description")
values
  ($1, $2, $3)
returning
  *

-- EventEntityRepository.update
update "event"
set
  "eventName" = $1
where
  "event"."id" = $2

-- EventEntityRepository.getStatistics
select
  count("event"."id") as "owned"
from
  "event"
where
  "event"."ownerId" = $1
  and "event"."deletedAt" is null
